"use strict";const{Utils}=require("utils"),{Notification}=require("notification"),{getActiveNotification,shouldDisplay}=require("notificationHelper");function getDocLinks(a){if(!a.links)return[];let b=[];return a.links.forEach(a=>{b.push(Utils.getDocLink(a))}),b}function insertMessage(a,b,c){let d=/^(.*?)<(a|strong)>(.*?)<\/\2>(.*)$/.exec(b);if(!d)return void a.appendChild(document.createTextNode(b));let e=d[1],f=d[2],g=d[3],h=d[4];insertMessage(a,e,c);let i=document.createElement(f);"a"===f&&c&&c.length&&(i.href=c.shift()),insertMessage(i,g,c),a.appendChild(i),insertMessage(a,h,c)}window.addEventListener("load",()=>{let a=getActiveNotification();if(!a||!shouldDisplay("popup",a.type))return;let b=Notification.getLocalizedTexts(a),c=document.getElementById("notification-title");c.textContent=b.title;let d=getDocLinks(a),e=document.getElementById("notification-message");insertMessage(e,b.message,d),e.addEventListener("click",a=>{let b=a.target;for(;b&&b!==e&&"a"!==b.localName;)b=b.parentNode;b&&(a.preventDefault(),a.stopPropagation(),ext.pages.open(b.href))});let f=document.getElementById("notification");f.className=a.type,f.hidden=!1,f.addEventListener("click",b=>{"notification-close"==b.target.id?f.classList.add("closing"):("notification-optout"==b.target.id||"notification-hide"==b.target.id)&&("notification-optout"==b.target.id&&Notification.toggleIgnoreCategory("*",!0),f.hidden=!0,a.onClicked())},!0)},!1);