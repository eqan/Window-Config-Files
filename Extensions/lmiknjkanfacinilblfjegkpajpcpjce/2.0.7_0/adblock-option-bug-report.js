var debugInfo,textDebugInfo="",extInfo="",backgroundPage=ext.backgroundPage.getWindow();$(document).ready(function(){'use strict';var a=function(){chrome&&chrome.permissions&&chrome.permissions.request?chrome.permissions.request({permissions:["management"]},function(a){a?chrome.management.getAll(function(a){for(var b=[],c=0;c<a.length;c++)b.push("Number "+(c+1)),b.push("  name: "+a[c].name),b.push("  id: "+a[c].id),b.push("  version: "+a[c].version),b.push("  enabled: "+a[c].enabled),b.push("  type: "+a[c].type),b.push("");extInfo="\nExtensions:\n"+b.join("\n"),chrome.permissions.remove({permissions:["management"]},function(){}),j()}):(extInfo="Permission not granted",j())}):(extInfo="no extension information",j())};backgroundPage.getDebugInfo(function(a){debugInfo={},debugInfo.filter_lists=JSON.stringify(a.subscriptions,null,"\t"),debugInfo.other_info=JSON.stringify(a.other_info,null,"\t"),debugInfo.custom_filters=a.custom_filters,debugInfo.settings=JSON.stringify(a.settings,null,"\t"),debugInfo.language=determineUserLanguage();var b=[];if(a.subscriptions)for(var c in b.push("=== Filter Lists ==="),a.subscriptions)b.push("Id: "+c),b.push("  Download Count: "+a.subscriptions[c].downloadCount),b.push("  Download Status: "+a.subscriptions[c].downloadStatus),b.push("  Last Download: "+a.subscriptions[c].lastDownload),b.push("  Last Success: "+a.subscriptions[c].lastSuccess);if(b.push(""),a.custom_filters){for(var d in b.push("=== Custom Filters ==="),a.custom_filters)b.push(a.custom_filters[d]);b.push("")}for(var e in a.exclude_filters&&(b.push("=== Exclude Filters ==="),b.push(JSON.stringify(a.exclude_filters))),b.push("=== Settings ==="),a.settings)b.push(e+" : "+a.settings[e]);b.push(""),b.push("=== Other Info ==="),b.push(JSON.stringify(a.other_info,null,"\t")),textDebugInfo=b.join("\n")});var b=$("#name"),c=$("#email"),d=$("#summary"),e=$("#repro-steps"),f=$("#expected-result"),g=$("#actual-result"),h=$("#other-comments");chrome.storage.local.get("user_name",function(a){b.val(a.user_name)}),chrome.storage.local.get("user_email",function(a){c.val(a.user_email)});var i=function(){var a={title:d.val(),repro:e.val(),expect:f.val(),actual:g.val(),debug:debugInfo,name:b.val(),email:c.val(),comments:h.val()};extInfo&&(a.debug.extensions=extInfo)},j=function(){$("#debug-info").val(textDebugInfo),$("#step2-back").prop("disabled",!1),$("#step_final_questions").fadeIn(),$("html, body").animate({scrollTop:15e3},50),$("#rememberDetails").is(":checked")&&(chrome.storage.local.set({user_name:b.val()}),chrome.storage.local.set({user_email:c.val()}))};$("#step1-next").click(function(){var h=0;""===b.val()?(h++,b.addClass("inputError")):b.removeClass("inputError"),""===c.val()||-1===c.val().search(/^.+@.+\..+$/)?(h++,c.addClass("inputError")):c.removeClass("inputError"),""===d.val()?(h++,d.addClass("inputError")):d.removeClass("inputError"),"1. \n2. \n3. "===e.val()?(h++,e.addClass("inputError")):e.removeClass("inputError"),""===f.val()?(h++,f.addClass("inputError")):f.removeClass("inputError"),""===g.val()?(h++,g.addClass("inputError")):g.removeClass("inputError"),0==h?($(this).prop("disabled",!0),$("#email, #name, #rememberDetails").prop("disabled",!0),$("#summary, #repro-steps, #expected-result, #actual-result").prop("disabled",!0),$(".missingInfoMessage").hide(),a()):$("#step_name_email > .missingInfoMessage").show()}),$("#step2-back").click(function(){$("#email, #name, #rememberDetails").prop("disabled",!1),$("#summary, #repro-steps, #expected-result, #actual-result").prop("disabled",!1),$("#step_repro_info").fadeOut(),$("#step_final_questions").fadeOut(),$("html, body").animate({scrollTop:$("#step_name_email").parent().parent().offset().top},2e3),$("#step2-back").prop("disabled",!0),$("#step1-next").prop("disabled",!1)}),$("#submit").click(function(){i(),$("#submit").prop("disabled",!0),$("#step2-back").prop("disabled",!0)})});