"use strict";(self.webpackChunkbardeen_browser_extension=self.webpackChunkbardeen_browser_extension||[]).push([[8900],{66472:(e,t,r)=>{r.d(t,{c:()=>s,$:()=>n});const s="=";var n;!function(e){e.Annotation="[[Annotation]]",e.Group="[[Group]]",e.Internal="[[Internal]]",e.Boolean="boolean",e.Date="date",e.DateRange="date_range",e.Duration="duration",e.ExpressionOperator="expressionOperator",e.Integer="integer",e.Number="number",e.Object="object",e.String="string",e.Type="type",e.Nothing="nothing"}(n||(n={}))},17938:(e,t,r)=>{r.d(t,{g:()=>o}),r(67933),r(37439);var s=r(20306),n=r(80634),a=r(91777);function o(e,t){class r extends n.b{static isValidValue(e){return t.some((t=>t.value===e))}static createWithValue(t){if(!r.isValidValue(t))throw a._F.from({typeName:e.typeName,value:t});return r.createWithID(t)}getValue(){return this.getId()}getDisplayDetails(){const r=this.getValue(),s=t.find((e=>e.value===r));if(!s)throw a._F.from({typeName:e.typeName,value:r});return s}}return r.typeName=e.typeName,r.Annotation=class{constructor(){this.type=r}async getDefaultAnnotation(){return{description:e.description||"An enumeration of choices",icon:e.defaultIcon}}async getInstanceAnnotation(e){const t=e.getDisplayDetails();return{label:t.label||t.value,description:t.description,icon:t.icon}}async getDefaultValueSuggestions(){return t.map((e=>r.createWithValue(e.value)))}},r.Renderer=class{constructor(e){this.dataTypes=[r],this.struct=s.i.Scalar,this.ctx=e}async render(e){const t=e[0];if(!t)return null;const r=t.getDisplayDetails();return{contextIcon:r.icon,textContent:[{type:"plaintext",body:r.label||r.value}]}}},r}},46048:(e,t,r)=>{r.d(t,{_:()=>s});const s=(0,r(54178).n)({clientErrorCode:"NotInDEnumError",message:"Invalid enum value.",userHint:"You tried to create an enum with a non-accepted value.",trackError:"default",arguments:[]})},91777:(e,t,r)=>{r.d(t,{I:()=>s.I,Hb:()=>n.H,_F:()=>a._,D3:()=>o.D});var s=r(2937),n=r(47682),a=r(46048),o=r(96287)},4187:(e,t,r)=>{r.d(t,{k:()=>a});var s=r(80634),n=r(7504);class a extends s.b{static requireMime(e){const t=Array.isArray(e)?e:[e];return e=>{if(!("mimeType"in e))return!1;const r=String(e.mimeType);return!!t.some((e=>{if(e.endsWith("/")){if(r.startsWith(e))return!0}else if(r===e)return!0;return!1}))}}getBuffer(e){return Promise.reject(n.zk.from({originalError:"Base IDBlob has no means for yielding a buffer",component:"IDBlob"}))}}a.typeName="blob"},56548:(e,t,r)=>{r.d(t,{z:()=>o});var s=r(10204),n=r.n(s),a=r(4187);r(80634);class o extends a.k{static createWithBuffer(e,t,r){const s=n().buf(new Uint8Array(e)).toString(16).padStart(8,"0");return o.createWithID(s,{...r,mimeType:t||"text/plain",buffer:e})}getBuffer(e){return Promise.resolve(this.buffer)}serialize(){const e=super.serialize();return e.buffer=new Uint8Array(this.buffer),e}}o.typeName="blob.buffered"},83825:(e,t,r)=>{r.d(t,{k:()=>a});var s=r(4187),n=r(7504);class a extends s.k{getBuffer(e){var t;return e.network.fetch(this.url,{method:this.method,headers:this.headers,signal:null===(t=e.prog)||void 0===t?void 0:t.getAbortSignal()}).then((e=>e.ok?e.arrayBuffer():Promise.reject(n.tw.from({originalError:e.statusText,httpStatus:e.status,url:this.url}))))}serialize(){const e=super.serialize();return e.url=this.url,e.headers=this.headers,e.method=this.method,e}}a.typeName="blob.http"},97118:(e,t,r)=>{r.d(t,{l:()=>n});var s=r(4187);class n extends s.k{getBuffer(e){return this.provider.getBuffer(e)}serialize(){throw new TypeError("A provided IDBlob cannot be serialized")}}n.typeName="blob.provided"},38913:(e,t,r)=>{r.d(t,{D:()=>i});var s=r(10204),n=r.n(s),a=r(4187),o=r(28265);r(80634);class i extends a.k{static createWithText(e,t,r){const s=(new o.p).encode(e),a=n().buf(new Uint8Array(s)).toString(16).padStart(8,"0");return this.createWithID(a,{...r,mimeType:t||"text/plain",text:e})}getBuffer(e){return Promise.resolve((new o.p).encode(this.text))}toString(){return this.text}serialize(){const e=super.serialize();return e.text=this.text,e}}i.typeName="blob.text"},82986:(e,t,r)=>{r.d(t,{b:()=>n});var s=r(38913);class n extends s.D{static fromURL(e,t){const r=e.toString();return this.createWithID(r,{...t,mimeType:"text/x-url",text:r})}}n.typeName="link"},63697:(e,t,r)=>{r.d(t,{A:()=>n});var s=r(80634);class n extends s.b{}n.typeName="email"},61382:(e,t,r)=>{r.d(t,{t:()=>n});var s=r(9193);class n extends s.u{constructor(){super(...arguments),this.doNotReply=!1,this.mailingList=!1}}n.typeName="emailaddress",n.typeDesc="An e-mail address"},24:(e,t,r)=>{r.d(t,{I:()=>n});var s=r(67825);class n extends s.KO{}n.typeName="email.attachment"},65505:(e,t,r)=>{r.d(t,{E:()=>n});var s=r(80634);class n extends s.b{toString(){return this.name}}n.typeName="email.label"},71569:(e,t,r)=>{r.d(t,{n:()=>o});var s=r(55359),n=r(63697),a=r(24);class o extends((0,s.P)(n.A,a.I)){}o.typeName="email-attachment"},13824:(e,t,r)=>{r.d(t,{l:()=>o});var s=r(55359),n=r(63697),a=r(65505);class o extends((0,s.P)(n.A,a.E)){}o.typeName="email-label"},36114:(e,t,r)=>{r.d(t,{L:()=>o});var s=r(55359),n=r(25347),a=r(56821);class o extends((0,s.P)(a.E,n.u5)){}o.typeName="event-participant"},54946:(e,t,r)=>{r.d(t,{L:()=>s.L});var s=r(36114)},89488:(e,t,r)=>{r.d(t,{N:()=>n});var s=r(80634);r(30325);class n extends s.b{}n.typeName="fsnode"},99146:(e,t,r)=>{r.d(t,{K:()=>o});var s=r(73497),n=r(30796),a=r(89488);class o extends((0,s.JM)(n.ky,a.N)){}o.typeName="idfile"},39117:(e,t,r)=>{r.d(t,{O:()=>o});var s=r(73497),n=r(30796),a=r(89488);class o extends((0,s.JM)(n.zi,a.N)){}o.typeName="file.buffered"},72215:(e,t,r)=>{r.d(t,{K:()=>o});var s=r(73497),n=r(30796),a=r(89488);class o extends((0,s.JM)(n.kU,a.N)){}o.typeName="file.http"},92536:(e,t,r)=>{r.d(t,{T:()=>o});var s=r(73497),n=r(30796),a=r(89488);class o extends((0,s.JM)(n.DV,a.N)){}o.typeName="file.text"},1127:(e,t,r)=>{r.d(t,{o:()=>n});var s=r(80634);class n extends s.b{}n.typeName="file_user"},93804:(e,t,r)=>{r.d(t,{Q:()=>n});var s=r(72215);class n extends s.K{}n.typeName="file.media.http"},98492:(e,t,r)=>{r.d(t,{w:()=>a});var s=r(55359),n=r(89488);class a extends((0,s.P)(n.N,n.N)){}a.typeName="file-child"},13220:(e,t,r)=>{r.d(t,{z:()=>o});var s=r(55359),n=r(1127),a=r(89488);class o extends((0,s.P)(a.N,n.o)){constructor(){super(...arguments),this.canWrite=!0,this.canCreate=!0,this.canDelete=!0}}o.typeName="file-collaborator"},18020:(e,t,r)=>{r.d(t,{$:()=>o});var s=r(55359),n=r(1127),a=r(89488);class o extends((0,s.P)(a.N,n.o)){}o.typeName="file-creator"},30797:(e,t,r)=>{r.d(t,{z:()=>o});var s=r(55359),n=r(1127),a=r(89488);class o extends((0,s.P)(a.N,n.o)){}o.typeName="file-user"},60244:(e,t,r)=>{r.d(t,{wc:()=>s.w,zh:()=>n.z,zW:()=>a.z,$H:()=>o.$});var s=r(98492),n=r(13220),a=r(30797),o=r(18020)},78319:(e,t,r)=>{r.d(t,{x:()=>n});var s=r(12543);class n extends s.O2{}n.typeName="action"},23683:(e,t,r)=>{r.d(t,{n:()=>s});const s=(0,r(17938).g)({typeName:"bardeen.partition.strategy",description:"Selects how to process the condition expression and how to invoke the truthy / falsy branches"},[{value:"some",label:"Run YES if at least one item matches the condition"},{value:"every",label:"Run YES if all items match the condition"},{value:"partition",label:"Run both YES and NO, with the respective portion of items"}])},4139:(e,t,r)=>{r.d(t,{x:()=>s.x,n:()=>n.n});var s=r(78319),n=r(23683)},22071:(e,t,r)=>{r.d(t,{U:()=>n});var s=r(80634);class n extends s.b{}n.typeName="person"},9193:(e,t,r)=>{r.d(t,{u:()=>n});var s=r(80634);class n extends s.b{}n.typeName="personid"},40066:(e,t,r)=>{r.d(t,{R:()=>i});var s=r(73880),n=r.n(s),a=r(9193),o=r(93549);class i extends a.u{static async createParsingPhoneNumber(e,t){const r=t||await(0,o.g)(),s=new(n())(e,r);let a="",c="",d=e;return s.isPossible()&&(a=s.getRegionCode(),c=s.getNumber("international"),d=s.getNumber("e164")),i.createWithID(d,{country:a,international:c,raw:e})}toString(){return this.international?this.international:this.raw}}i.typeName="phone"},25347:(e,t,r)=>{r.d(t,{UT:()=>s.U,u5:()=>n.u,Rz:()=>a.R,AY:()=>o.A});var s=r(22071),n=r(9193),a=r(40066),o=r(31833)},32764:(e,t,r)=>{r.d(t,{A:()=>o});var s=r(55359),n=r(22071),a=r(9193);class o extends((0,s.P)(n.U,a.u)){}o.typeName="identifiedby"},31833:(e,t,r)=>{r.d(t,{A:()=>s.A});var s=r(32764)},51159:(e,t,r)=>{r.d(t,{a:()=>n});var s=r(12543);class n extends s.O2{}n.typeName="core.numidex"},13945:(e,t,r)=>{r.d(t,{a:()=>n});var s=r(12543);class n extends s.O2{}n.typeName="core.sortorder"},59929:(e,t,r)=>{r.d(t,{z:()=>s.a,a:()=>n.a});var s=r(13945),n=r(51159)},17847:(e,t,r)=>{r.d(t,{Z:()=>o});var s=r(29174),n=r(60463),a=r(54109);class o extends s.v{constructor(){super(...arguments),this.rootArray=!0}static fromJSON(e){const t=a.b.fromPrimitiveObjects(e);return Array.isArray(e)?o.create({data:e.map((e=>n.A.fromObjectWithSchema(e,t))),rootArray:!0,schema:t}):o.create({data:[n.A.fromObjectWithSchema(e,t)],rootArray:!1,schema:t})}static fromTabularData(e){return o.create({data:e.data,schema:e.schema,rootArray:!1})}toJSON(){return this.data.length?this.data.length>1?this.data.map((e=>i(e))):1===this.data.length?i(this.data[0]):void 0:null}}function i(e){const t={};if(e.records)for(const r in e.records){const s=e.records[r];void 0!==s&&(t[r]=s)}return t}o.typeName="core.data.json"},15126:(e,t,r)=>{r.d(t,{n:()=>n});var s=r(12543);class n extends s.O2{}n.typeName="core.table.primitive"},29174:(e,t,r)=>{r.d(t,{v:()=>l});var s=r(12543),n=r(15126),a=r(60463),o=r(54109),i=r(17857),c=r(55068),d=r(20306);class l extends s.O2{static async reflectSchemaFields(e,t){const r=await e.getCommandArgumentValue(t,l);if(r[0]&&r[0].schema)return r[0].schema.fields;const s=await e.getCommandArgumentTypes(t);if(s[0]){const e=s[0].getConfigOptions();if(e)return e.schema.fields.map((e=>{const{_types:t,...r}=e;return i.j.create(r)}))}return[]}static fromObject(e){const t=o.b.fromPrimitiveObjects(e);return l.create({schema:t,data:[a.A.fromObjectWithSchema(e,t)]})}static fromObjects(e){const t=o.b.fromPrimitiveObjects(e);return l.create({schema:t,data:e.map((e=>a.A.fromObjectWithSchema(e,t)))})}static withSchema(e,t){var r;const s=0===e.fields.length;return l.withConfigOptions({schema:e,editable:null!==(r=null==t?void 0:t.editable)&&void 0!==r?r:s,sourceIcon:null==t?void 0:t.sourceIcon,sourceName:null==t?void 0:t.sourceName})}async exportPrimitiveTable(e){const t=[];for(const r of this.data){if(null==r.records)continue;const s={};for(const t in r.records)s[t]=await e.getStringFromValue(r.records[t]);t.push({id:r.id,records:s})}return n.n.create({data:t,schema:this.schema})}static applyMapping(e,t){var r;const s=null===(r=null==e?void 0:e.schema)||void 0===r?void 0:r.fields.reduce(((e,r)=>{var s;const n=t.find((e=>e.original===r.name));return n?e.concat(i.j.create({name:n.renamed,editable:r.editable,title:null!==(s=r.title)&&void 0!==s?s:r.name,type:r.type})):e}),[]),n=null==e?void 0:e.data.map((e=>{const r={};for(const s in e.records){const n=t.find((e=>e.original===s)),a=e.records[s];null!=a&&n&&(r[n.renamed]=a)}return a.A.create({id:e.id,records:r})}),[]);return l.create({data:n,schema:s?o.b.create({fields:s}):void 0})}static composeTable(e,t){const r=Object.keys(e),s=Object.fromEntries(r.map((e=>[e,d.i.Scalar]))),n=c.B.unpack(e,s,{unpackNothing:!0}),o=[];for(const e of n){let t=!0;const s={};for(const n of r){const r=e.values[n];if(c.B.isNothing(r))continue;const a=c.B.flatten(r).filter((e=>!c.B.isNothing(e))).map((e=>e.value));0!==a.length&&(t=!1),s[n]=a[0]}t||o.push({path:e.path,records:s})}const i=new Map,h=[];for(const e of o){const r=e.path.slice(0,e.path.length-1),s=c.B.pathKey(r);let n=i.get(s);n||(n=l.create({data:[],schema:t}),i.set(s,n),h.push({path:0===r.length?[{kind:c.Q.Kind.Leaf}]:r,value:c.B.leaf(n)})),n.data.push(a.A.create({records:e.records}))}return c.B.pack(h)}}l.typeName="tabular-data"},93477:(e,t,r)=>{r.d(t,{O:()=>n});var s=r(80634);r(54109);class n extends s.b{}n.typeName="table-meta"},54743:(e,t,r)=>{r.d(t,{V:()=>n});var s=r(12543);class n extends s.O2{static fromDate(e){const t=new Date(e);return n.create({day:t.getDate(),month:t.getMonth(),year:t.getFullYear()})}toDate(){return new Date(this.year,this.month,this.day,0,0,0,0)}}n.typeName="builtin.date-only"},3881:(e,t,r)=>{r.d(t,{w:()=>n});var s=r(12543);class n extends s.O2{}n.typeName="recurrence.stop",n.typeDesc="when to stop a recurring event"},33326:(e,t,r)=>{r.d(t,{e:()=>n});var s=r(12543);class n extends s.O2{static fromDate(e){const t=new Date(e);return n.create({hours:t.getHours(),minutes:t.getMinutes(),seconds:t.getSeconds(),ms:t.getMilliseconds(),tz:t.getTimezoneOffset()})}toDate(){const e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate(),this.hours,this.minutes,this.seconds,this.ms)}}n.typeName="builtin.time-only"},1009:(e,t,r)=>{r.d(t,{VJ:()=>s.V,eU:()=>n.e,wH:()=>a.w,ei:()=>o.e});var s=r(54743),n=r(74170),a=r(3881),o=r(33326)},54178:(e,t,r)=>{r.d(t,{n:()=>a});var s=r(35198),n=r(56347);function a(e){return{clientErrorCode:e.clientErrorCode,from:t=>s.YY.from(e,t),fromResponse:async t=>{let r=await t.originalError.text();try{r=JSON.parse(r)}catch(e){}const n={...t,originalError:r,status:t.originalError.status,url:t.originalError.url};return s.YY.from(e,n)},is:t=>(0,n.Je)(t)&&(0,n.WX)(t,e.clientErrorCode)}}},60961:(e,t,r)=>{r.d(t,{t:()=>a});var s=r(54178),n=r(46831);const a=(0,s.n)({clientErrorCode:"BlobDownloadError",message:"Fetching data via the network layer service API failed.",userHint:"There was an error fetching data. Please try again.",trackError:"default",arguments:[{name:"httpStatus",type:Number,struct:n.f.Scalar},{name:"url",type:String,struct:n.f.Scalar}]})},51710:(e,t,r)=>{r.d(t,{l:()=>s});const s=(0,r(54178).n)({clientErrorCode:"GraphMisalignedError",message:"Misaligned graph.",userHint:"We encountered an unexpected error while executing your automation and we are unable to continue. Please reach-out to our slack channel, or send us an e-mail to help you resolve this issue.",trackError:"default",arguments:[]})},18388:(e,t,r)=>{r.d(t,{N:()=>s});const s=(0,r(54178).n)({clientErrorCode:"GraphTooManyError",message:"Too many values.",userHint:"We were expecting to find a single value but we found more instead.",trackError:"default",arguments:[]})},95265:(e,t,r)=>{r.d(t,{z:()=>a});var s=r(54178),n=r(46831);const a=(0,s.n)({clientErrorCode:"NonApplicableOperationError",message:"The operation is not applicable.",userHint:"Your interaction triggered an operation which is not supported or implemented. It will likely fail again if you retry, so we'll be investigating why you encountered this issue.",trackError:"default",arguments:[{name:"component",type:String,struct:n.f.Scalar}]})},37668:(e,t,r)=>{r.d(t,{n:()=>s});const s=(0,r(54178).n)({clientErrorCode:"NotImplementedError",message:"A method is not implemented.",userHint:"This method is not implemented.",trackError:"default",arguments:[]})},83762:(e,t,r)=>{r.d(t,{S:()=>s});const s=(0,r(54178).n)({clientErrorCode:"RemoteFetchError",message:"Fetching data via our remote Bardeen service API failed.",userHint:"There was an error fetching data. Please try again.",trackError:"default",arguments:[]})},85555:(e,t,r)=>{r.d(t,{s:()=>a});var s=r(54178),n=r(46831);const a=(0,s.n)({clientErrorCode:"ResponseParseError",message:"Failed to parse JSON.",userHint:"Unexpected content of a presumes JSON message. Response content is {{{text}}}.",trackError:"default",arguments:[{name:"text",type:String,struct:n.f.Scalar}]})},38139:(e,t,r)=>{r.d(t,{G:()=>s});var s,n=r(16135),a=r(55068);!function(e){function t(e){const t=Object.keys(e);let r;for(const s of t){const t=e[s];t&&(r=r?a.B.merge(r,t):t)}return null!=r?r:a.B.nothing()}e.empty=function(){return{}},e.from=function(e){return{[n.L]:e}},e.isMultiportData=function(e){return"object"==typeof e&&null!=e&&Object.getPrototypeOf(e)===Object.prototype},e.isEmpty=function(e){return Object.values(e).every((e=>a.B.isEmpty(e)))},e.unify=t,e.getOnlyType=function(e,r){const s=Array.isArray(r)?r:[r],n=t(e),[o,i]=a.B.partition(n,(e=>s.some((t=>e.value.is(t)))));return o},e.merge=function(e,t){const r={},s=Array.from(new Set([...Object.keys(e),...Object.keys(t)]));for(const n of s){const s=e[n],o=t[n];(s||o)&&(s&&!o?r[n]=s:!s&&o?r[n]=o:s&&o&&(r[n]=a.B.merge(s,o)))}return r},e.map=function(e,t){const r=Object.keys(e),s={};for(const n of r){const r=e[n];r&&(s[n]=t(r,n))}return s},e.some=function(e,t){return Object.values(e).some(t)},e.reduceAsync=async function(e,t,r){let s=r;const n=Object.keys(e);for await(const r of n)s=await t(s,e[r],r);return s}}(s||(s={}))},65508:(e,t,r)=>{r.d(t,{G:()=>s});const s=(0,r(54178).n)({clientErrorCode:"ApiClientError",message:"Client send an invalid request.",userHint:"Client send an invalid request",trackError:"default",arguments:[]})},91854:(e,t,r)=>{r.d(t,{S:()=>s});const s=(0,r(54178).n)({clientErrorCode:"ApiClientNotFoundError",message:"Resource not found.",userHint:"Some data from an integrated app could not be loaded.",trackError:"default",arguments:[]})},12028:(e,t,r)=>{r.d(t,{I:()=>s});const s=(0,r(54178).n)({clientErrorCode:"ApiClientRateLimitedError",message:"Too Many Requests.",userHint:"Bardeen has been doing too many requests against an integrated service. Likely, your Playbook is read or update a lot of data, which is not supported at this point. Try to limit the amount of data you are reading or updating, and try again.",trackError:"default",arguments:[]})},5010:(e,t,r)=>{r.d(t,{h:()=>s});const s=(0,r(54178).n)({clientErrorCode:"ApiClientUnauthorizedError",message:"User is not authorized.",userHint:"User is not authorized",trackError:"default",arguments:[]})},64345:(e,t,r)=>{r.d(t,{h:()=>s});const s=(0,r(54178).n)({clientErrorCode:"ApiHttpError",message:"API call failed.",userHint:"An error occurred calling out to an API.",trackError:"default",arguments:[]})},81365:(e,t,r)=>{r.d(t,{t:()=>s});const s=(0,r(54178).n)({clientErrorCode:"ApiServerError",message:"Server could not handle the request.",userHint:"Server could not handle the request.",trackError:"default",arguments:[]})},66716:(e,t,r)=>{r.d(t,{GY:()=>s.G,SM:()=>n.S,Io:()=>a.I,hc:()=>o.h,hg:()=>i.h,tc:()=>c.t});var s=r(65508),n=r(91854),a=r(12028),o=r(5010),i=r(64345),c=r(81365)},45928:(e,t,r)=>{r.d(t,{o:()=>c,k:()=>d});var s=r(95733),n=r(18438),a=r(77903),o=r(66716),i=r(58499);class c extends s.x{constructor(){super(...arguments),this.lastError=[]}async getErrorFromResponse(e){const t=(0,a.Tn)(e)?await e.json():await e.text();return this.getErrorFromResponseBody(e,t)}async getErrorFromResponseBody(e,t){const r={url:e.url,status:e.status,statusText:e.statusText};switch(r.status){case 400:throw o.GY.from({originalError:t,...r});case 401:throw o.hc.from({originalError:t,...r});case 404:throw o.SM.from({originalError:t,...r});case 429:throw o.Io.from({originalError:t,...r});case 500:throw o.tc.from({originalError:t,...r});default:throw o.hg.from({originalError:t,...r})}}async fetchWrapper(e,t){const r=(0,i.K)(e,this.baseUrl),s=()=>this.fetch(r,t).then((async e=>e.ok?e:this.getErrorFromResponse(e)));return this.retryConfig?(0,n.retry)(s,this.retryConfig).catch((e=>{if(this.lastError.length>0)throw this.lastError.pop();if(e.lastError)throw e.lastError;throw e})):s()}setRetryConfig(e){this.retryConfig=e}post(e,t,r){return this.fetchWrapper(e,{method:"POST",body:t,headers:r})}get(e,t,r){return this.fetchWrapper(e+new URLSearchParams(t),{method:"GET",headers:r})}put(e,t,r){return this.fetchWrapper(e,{method:"PUT",body:t,headers:r})}patch(e,t,r){return this.fetchWrapper(e,{method:"PATCH",body:t,headers:r})}delete(e,t,r){return this.fetchWrapper(e,{method:"DELETE",body:t,headers:r})}}class d extends c{}},73132:(e,t,r)=>{r.d(t,{_:()=>a});var s=r(45928),n=r(77903);class a extends s.o{parseErrorCode(e){return(e.error||{}).code}parseErrorMessage(e){return(e.error||{}).message}async parseJsonBody(e){const t=await e.json();return null!=this.parseErrorCode(t)?this.getErrorFromResponseBody(e,t):t}async fetchWrapper(e,t){const r=new URL(e,this.baseUrl||void 0).toString();t.body=t.body?o(t.body):null;const s=await super.fetchWrapper(r,t);return 0===parseInt(s.headers.get("content-length"))?null:(0,n.Tn)(s)?this.parseJsonBody(s):(0,n.P0)(s)?s.text():s.blob()}}const o=e=>"object"==typeof e&&e.constructor==Object?JSON.stringify(e):e},16402:(e,t,r)=>{r.d(t,{p:()=>a});var s=r(82020),n=(r(95733),r(45928));class a extends n.k{constructor(e){super(e),this.decodeUrl=!0,this.serviceApi=new s.p(super.fetch.bind(this),e.config)}fetch(e,t){const r=()=>{const r=Object.assign({},t);return this.auth.authParams(r).then((t=>this.serviceApi.remoteFetch(t.redirectUrl||e,t,this.decodeUrl)))};return r().then((e=>!e.ok||e.status>=400?this.handleErrorResponse(e,r):e))}}},52090:(e,t,r)=>{r.d(t,{D:()=>s,o:()=>a});var s,n=r(7504);r(81065),function(e){e[e.AtRedirectAway=0]="AtRedirectAway",e[e.AtRedirectToCallback=1]="AtRedirectToCallback",e[e.AtSystemPrompt=2]="AtSystemPrompt"}(s||(s={}));class a{constructor(e){this.accountApi=e.accountApi,this.callbackUrl=e.callbackUrl,this.manifest=e.manifest,this.network=e.network,this.persistence=e.persistence,this.persistenceLifecycle=e.persistence,this.manager=e.manager,this.ctx=e.ctx}get integrationName(){var e;return(null===(e=this.manifest)||void 0===e?void 0:e.name)||"Bardeen"}fetch(e,t){return this.network.fetch(e,t)}resume(){return Promise.reject(n.nj.from({}))}refresh(e){return Promise.reject(n.nj.from({}))}revoke(){return Promise.resolve()}async destroy(){this.persistenceLifecycle.destroy()}start(){return Promise.reject(n.nj.from({}))}finalize(e,t){return Promise.reject(n.nj.from({}))}getTerminationCondition(){return a.Termination.AtRedirectAway}getRefreshInterval(){return 0}declareSessionLost(){}}a.PersistedDataBlueprint={tsIssued:0,access_token:"",expires_in:0,refresh_token:"",scope:[""],tsExpires:0},a.Termination=s},59753:(e,t,r)=>{var s;r.d(t,{a:()=>s}),function(e){e.Text="text",e.Password="password",e.TextArea="textarea"}(s||(s={}))},96340:(e,t,r)=>{r.d(t,{g:()=>s});const s=(0,r(54178).n)({clientErrorCode:"AuthExchangeError",message:"Exchanging an OAuth2 code for an access and refresh token failed.",userHint:"Obtaining an access token failed. Please try again.",trackError:"default",arguments:[]})},89173:(e,t,r)=>{r.d(t,{U:()=>s});const s=(0,r(54178).n)({clientErrorCode:"AuthMissingRefreshTokenError",message:"The server did not return a refresh token.",userHint:"The server did not include a refresh token. This usually happens if you have installed this app multiple times in your account.",trackError:"default",arguments:[]})},20255:(e,t,r)=>{r.d(t,{D:()=>a});var s=r(54178),n=r(46831);const a=(0,s.n)({clientErrorCode:"AuthRefreshError",message:"Failed to refresh an auth token.",userHint:"Unable to refresh your authentication credentials.",trackError:"default",arguments:[{name:"integrationName",type:String,struct:n.f.Scalar},{name:"reason",type:String,struct:n.f.Scalar}]})},41761:(e,t,r)=>{r.d(t,{Z:()=>a});var s=r(54178),n=r(46831);const a=(0,s.n)({clientErrorCode:"AuthRefreshInProgressError",message:"Auth flow is already refreshing.",userHint:"Bardeen is currently refreshing yet another refresh was triggered.",trackError:"default",arguments:[{name:"integrationName",type:String,struct:n.f.Scalar},{name:"reason",type:String,struct:n.f.Scalar}]})},89382:(e,t,r)=>{r.d(t,{g:()=>a});var s=r(54178),n=r(46831);const a=(0,s.n)({clientErrorCode:"AuthResumeError",message:"App must be authenticated again.",userHint:"It seems you haven't used {{{integrationName}}} for a while and your credentials have expired. Please connect this integration again to keep using your automations.",trackError:"default",arguments:[{name:"integrationName",type:String,struct:n.f.Scalar}]})},12121:(e,t,r)=>{r.d(t,{M:()=>a});var s=r(54178),n=r(46831);const a=(0,s.n)({clientErrorCode:"AuthScopeConfirmationError",message:"Missing permissions.",userHint:"Seems like you missed some required permissions. We'll walk you through the authorization again. Please check all the boxes to make {{{integrationName}}} useful!",trackError:"default",arguments:[{name:"integrationName",type:String,struct:n.f.Scalar},{name:"missingScopes",type:String,struct:n.f.Array}]})},54944:(e,t,r)=>{r.d(t,{q:()=>o}),r(85540);var s=r(52090),n=r(59753),a=r(75822);class o extends s.o{constructor(){super(...arguments),this.authData={}}async deserializeSession(){const e=await this.persistence.getRecord();if(!(null==e?void 0:e.authData)){const e=a.g5.from({integrationName:this.integrationName,reason:"Session does not exist"});return Promise.reject(e)}return this.authData=e.authData,this}getTerminationCondition(){return s.D.AtSystemPrompt}authQueryArgs(){const e=new URLSearchParams;return Promise.resolve(e)}getPromptTitle(){return""}getPromptLogo(){return""}getPromptDescription(){return""}getFields(){return[{label:"API Key",name:"token",type:n.a.TextArea}]}getToken(){return this.authData.token||""}async resume(){return this.deserializeSession()}async refresh(e){switch(e){case"init":case"lazy-init":case"periodical":return this;case"unauthorized":throw a.DG.from({integrationName:this.integrationName,reason:"Your token is not valid anymore"})}}async revoke(){return this.manager.invalidateSession(this)}async start(){const e=this.getFields().map(((e,t)=>`field[${t}]=${encodeURIComponent(encodeURIComponent(e.label)+":"+e.name+":"+e.type)}`)).join("&");return"bardeen://prompts/custom?logo="+this.getPromptLogo()+"&title="+this.getPromptTitle()+"&description="+this.getPromptDescription()+"&"+e}async finalize(e){return this.authData=e,await this.persistence.setRecord({tsIssued:Date.now(),authData:e}),this}async authParams(e){const t=Object.assign({},e);return t.headers=Object.assign({},e.headers||{},{Authorization:"Bearer "+this.getToken()}),t}}o.PersistedDataBlueprint={tsIssued:0,authData:{}}},51442:(e,t,r)=>{r.d(t,{C:()=>i}),r(71209),r(85540);var s=r(52090),n=r(75822),a=r(79864),o=r(12483);class i extends s.o{constructor(e){super(e),this.token="",this.lastSuccessfulRefresh=0;const t=this.refresh.bind(this);let r=null;this.refresh=async e=>{if(r){const t=n.Zc.from({integrationName:this.integrationName,reason:e});return this.ctx.log.debug(t),r}return r=t(e),r.finally((()=>{r=null})),r}}getAuth(){if(!this.manifest)throw new Error("Missing `manifest` in the session creation arguments");if(!this.manifest.auth)throw new Error("Missing `auth` settings key in plugin manifest");return Promise.resolve(this.manifest.auth)}getToken(){return this.token}authQueryArgs(){const e=new URLSearchParams;return e.append("token",this.token),Promise.resolve(e)}parseCodeFromCallback(e){return e.code||""}parseAccessToken(e){return e.access_token||""}parseRefreshToken(e){return e.refresh_token||""}parseExpiresIn(e){return parseInt(e.expires_in||"0")}async isTokenValid(){const e=await this.persistence.getRecord();if(!e||!e.access_token)return!1;const t=e.tsIssued,r=e.tsExpires;return r>t?Date.now()<r:Date.now()<t+36e5}confirmScopesAfterRefresh(e,t){return e.scopesIgnoreOnRefresh?e.scopes||[]:this.parseScopes(e,t)}parseScopes(e,t){const r=e.scopes||[];if(!t.scope&&e.scopesAcceptUnconfirmed)return r;const s=e.scopeResponseDelimiter||" ",a=t.scope?t.scope.split(s):[],o=r.reduce(((e,t)=>(e.set(t,!0),e)),new Map);if(a.forEach((e=>{o.delete(e)})),o.size>0){const e=Object.keys(o),t=n.MD.from({integrationName:this.integrationName,missingScopes:e});throw this.ctx.log.error(t),t}return a}parseErrorMessage(e){return e.error_description||e.error||""}getRefreshTokenHeaders(e){return e}getRevokeTokenHeaders(e){return e}getExchangeCodeHeaders(e){return e}handleExchangeResponse(e){return Promise.resolve()}handleRefreshResponse(e){return Promise.resolve()}handleMissingRefreshToken(){return Promise.reject(n.Uw.from({integrationName:this.integrationName}))}async deserializeSession(){const e=await this.persistence.getRecord();if(!e||!e.access_token){const e=n.g5.from({originalError:"Session does not exist",integrationName:this.integrationName});return this.ctx.log.error(e),Promise.reject(e)}return this.token=e.access_token,this}parseExchangeCodeBody(e){return e.json()}async getExchangeCodeArguments(e){const t=await this.getAuth(),r=new URLSearchParams;return r.append("client_id",t.clientId),r.append("client_secret",t.clientSecret),r.append("code",e),r.append("redirect_uri",this.callbackUrl),r.append("grant_type","authorization_code"),Promise.resolve(r.toString())}async getRefreshArguments(e,t){const r=await this.getAuth(),s=new URLSearchParams;return s.append("client_id",r.clientId),s.append("client_secret",r.clientSecret||""),s.append("refresh_token",e),s.append("grant_type","refresh_token"),Promise.resolve(s.toString())}async getRevokeArguments(e){const t=new URLSearchParams;return t.append("token",e),t.toString()}getRevokeTokenMethod(){return"POST"}async getAuthorizationUrl(e,t){const r=await this.getAuth();return r.authorizationUrl+"?"+new URLSearchParams({...t,client_id:r.clientId,response_type:"code",redirect_uri:this.callbackUrl,scope:e.join(" ")})}async resume(){return o.n_({category:"auth",message:`Resuming session for ${this.integrationName}`,level:"info"}),this.deserializeSession()}async exchangeCodeForTokens(e){const t=await this.getAuth(),r=await this.getExchangeCodeArguments(e);return this.fetch(t.tokenUrl,{method:"POST",headers:this.getExchangeCodeHeaders({"Content-Type":"application/x-www-form-urlencoded"}),redirect:"follow",body:r}).then((e=>this.parseExchangeCodeBody(e))).then((async e=>{if(this.parseErrorMessage(e)){const t=n.g8.from({originalError:e,integrationName:this.integrationName});return this.ctx.log.error(t),o.Tb(t),Promise.reject(t)}const r=Date.now(),s=this.parseExpiresIn(e),a=1e3*s,i={access_token:this.parseAccessToken(e),refresh_token:this.parseRefreshToken(e),expires_in:s,tsIssued:r,tsExpires:r+a,scope:this.parseScopes(t,e)};return await this.persistence.setRecord(i),i.refresh_token||await this.handleMissingRefreshToken(),await this.handleExchangeResponse(e),this.deserializeSession()}))}async refresh(e){const t=await this.getAuth();o.n_({category:"auth",message:`refreshing session for ${this.integrationName} (${e})`,level:"info"});const r=await this.persistence.getRecord();if(!(null==r?void 0:r.refresh_token)){const e=n.DG.from({integrationName:this.integrationName,reason:"Server did not include a refresh token"});throw this.ctx.log.error(e),e}if(("init"===e||"lazy-init"===e)&&await this.isTokenValid())return this.deserializeSession();const s=await this.getRefreshArguments(r.refresh_token,e);return this.fetch(t.tokenUrl,{method:"POST",headers:this.getRefreshTokenHeaders({"Content-Type":"application/x-www-form-urlencoded"}),redirect:"follow",body:s}).then((e=>this.parseExchangeCodeBody(e))).then((async e=>{const s=this.parseErrorMessage(e);if(s){const e=n.g5.from({originalError:s,integrationName:this.integrationName,reason:"Could not refresh token"});return this.ctx.log.error(e),Promise.reject(e)}const a=Date.now(),o=this.parseExpiresIn(e),i=1e3*o,c=this.confirmScopesAfterRefresh(t,e),d=this.parseRefreshToken(e)||r.refresh_token,l={access_token:this.parseAccessToken(e),refresh_token:d,expires_in:o,tsIssued:a,tsExpires:a+i,scope:c};if(!l.access_token||!l.expires_in){const e=n.g5.from({originalError:"Missing fields in the response",integrationName:this.integrationName});return this.ctx.log.error(e),Promise.reject(e)}return this.lastSuccessfulRefresh=a,l.scope=this.confirmScopesAfterRefresh(t,e),await this.persistence.setRecord(l),await this.handleRefreshResponse(e),this.deserializeSession()})).catch((e=>{const t=(0,a.Je)(e)?e:n.g5.from({originalError:e,integrationName:this.integrationName});return this.ctx.log.error(t),Promise.reject(t)}))}async revoke(){await this.manager.invalidateSession(this);const e=await this.getAuth();if(!e.revokeUrl)return o.n_({category:"auth",message:`not revoking OAuth session for ${this.integrationName}: missing revoke URL`,level:"error"}),void this.ctx.log.warn(`not revoking OAuth session for ${this.integrationName}: missing revoke URL`);const t=await this.persistence.getRecord();if(!t||!t.access_token)return;const r=await this.getRevokeArguments(t.access_token);return this.fetch(e.revokeUrl,{method:this.getRevokeTokenMethod(),headers:this.getRevokeTokenHeaders({"Content-Type":"application/x-www-form-urlencoded"}),redirect:"follow",body:r}).then((async e=>e.ok?Promise.resolve():e.json().then((e=>{const t=e.error_description||e.error||"Unknown Error",r=`Could not revoke token: ${JSON.stringify(t)}`;return this.ctx.log.error(r),Promise.reject(r)}))))}getTerminationCondition(){return s.o.Termination.AtRedirectToCallback}async start(){o.n_({category:"auth",message:`starting flow for ${this.integrationName}`,level:"info"});const e=await this.getAuth(),t=e.scopes||[],r=e.extraUrlParameters||{};return this.getAuthorizationUrl(t,r)}async finalize(e,t){o.n_({category:"auth",message:`finalizing session for ${this.integrationName}`,level:"warning"});const r=this.parseCodeFromCallback(e);if(!r)throw new Error("Could not find a `code` argument in the OAuth2 callback data");return this.exchangeCodeForTokens(r)}async authParams(e){const t=Object.assign({},e);return t.headers=Object.assign({},e.headers||{},{Authorization:"Bearer "+this.token}),t}}i.PersistedDataBlueprint={tsIssued:0,access_token:"",expires_in:0,refresh_token:"",scope:[""],tsExpires:0}},51797:(e,t,r)=>{r.d(t,{B:()=>a});var s=r(51442),n=r(69121);class a extends((0,n.i)(s.C)){async getExchangeCodeArguments(e){const t=new URLSearchParams;return t.append("code",e),t.append("redirect_uri",this.callbackUrl),t.append("grant_type","authorization_code"),Promise.resolve(t.toString()+"&client_secret={{client_secret}}&client_id={{client_id}}")}async getRefreshArguments(e,t){const r=new URLSearchParams;return r.append("refresh_token",e),r.append("grant_type","refresh_token"),r.toString()+"&client_secret={{client_secret}}&client_id={{client_id}}"}async getAuthorizationUrl(e,t){const r=new URLSearchParams(t).toString(),s=await this.getAuth(),n=e.length?"&scope="+encodeURIComponent(e.join(" ")):"",a=s.authorizationUrl+"?client_id={{client_id}}&response_type=code&redirect_uri="+encodeURIComponent(this.callbackUrl)+n+(r?"&"+r:"");return this.getServiceAPI().redirectUrl(a)}}},69121:(e,t,r)=>{r.d(t,{i:()=>n});var s=r(82020);function n(e){return class extends e{getServiceAPI(){return this._serviceApi||(this._serviceApi=new s.p(this.network.fetch,this.manifest.api)),this._serviceApi}fetch(e,t){return this.getServiceAPI().remoteFetch(e.toString(),t,!0)}}}},82020:(e,t,r)=>{r.d(t,{p:()=>a});var s=r(28265),n=r(7504);class a{constructor(e,t){if(!(null==t?void 0:t.serviceEnclave))throw new Error("Missing 'api.serviceEnclave' parameter in the manifest");if(!(null==t?void 0:t.serviceId))throw new Error("Missing 'api.serviceId' parameter in the manifest");this.serviceEnclave=t.serviceEnclave,this.serviceId=t.serviceId,this._fetch=e}static setAccountAPI(e){a.accountAPI=e}redirectUrl(e){const t=`proxy/${this.serviceId}?enclave=${encodeURIComponent(this.serviceEnclave)}&redirect=${encodeURIComponent(e)}`;return a.accountAPI?a.accountAPI.computeGetURL(t):Promise.resolve(t)}async remoteCall(e,t={}){const r=`${e}/${this.serviceId}`;return(a.accountAPI?a.accountAPI.fetch.bind(a.accountAPI):this._fetch)(r,{method:"POST",headers:{"X-Service-Enclave":this.serviceEnclave,"Content-Type":"application/json"},body:JSON.stringify(t)})}async remoteFetch(e,t,r){const s=`proxy/${this.serviceId}`,i=a.accountAPI?a.accountAPI.fetch.bind(a.accountAPI):this._fetch,c={url:e,method:t.method||"get",responseType:"text",headers:t.headers,data:t.body};r||(c.decodeUrl=r);const d=await i(s,{method:"POST",headers:{"X-Service-Enclave":this.serviceEnclave,"Content-Type":"application/json"},body:JSON.stringify(c)});if(!d.ok)throw await n.SJ.fromResponse({originalError:d});const l=await d.json();return new o(l)}}class o{constructor(e){this.status=e.status,this.statusText=e.statusText,this.ok=this.status>=200&&this.status<300,this.redirected=!1,this.type="basic",this.url=e.url,this.remoteBody=e.data,this.body=e.data,this.bodyUsed=!1,this.headers=new Headers,Object.keys(e.headers).forEach((t=>{this.headers.append(t,e.headers[t])}))}clone(){return this}arrayBuffer(){return this.text().then((e=>(new s.p).encode(e)))}blob(){const e=this.headers.get("content-type")||"text/plain";return this.arrayBuffer().then((t=>new Blob([t],{type:e})))}formData(){throw new Error("Method not implemented.")}async json(){if("string"!=typeof this.remoteBody)return Promise.resolve(this.remoteBody);const e=await this.text();if(!e)return{};try{return JSON.parse(e)}catch(t){throw n.s0.from({originalError:t,text:e})}}text(){return"string"!=typeof this.remoteBody?Promise.resolve(JSON.stringify(this.remoteBody)):Promise.resolve(this.remoteBody)}}},13437:(e,t,r)=>{r.d(t,{S:()=>a}),r(50312);var s=r(71209),n=r(88767);function a(e){return{node:{type:s.Ab.NodeType.Value,contextMeta:[],nodeId:(0,n.Z)(),value:e.serialize(),valueType:{typeId:0},output:"compute"},spec:{playbooks:[],plugins:[],types:[{facets:e.getTypes()}],version:1}}}}}]);