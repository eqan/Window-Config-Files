"use strict";(self.webpackChunkbardeen_browser_extension=self.webpackChunkbardeen_browser_extension||[]).push([[831],{94216:(e,t,n)=>{function r(e){const t={bubbles:!0};e.dispatchEvent(new MouseEvent("mousedown",t)),e.focus(),e.click(),e.dispatchEvent(new MouseEvent("mouseup",t))}function o(e,t){e.focus();const n={bubbles:!0},o=e.closest('[contenteditable="true"]');r(e),o?e.textContent=t:e.value=t,e.dispatchEvent(new Event("keydown",n)),e.dispatchEvent(new Event("keypress",n)),e.dispatchEvent(new Event("input",n)),e.dispatchEvent(new Event("change",n)),e.dispatchEvent(new Event("keyup",n))}n.d(t,{S:()=>r,_:()=>o})},74632:(e,t,n)=>{function r(e){return window.CSS&&"escape"in window.CSS?CSS.escape(e):function(e){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");const t=String(e),n=t.length;let r,o=-1,s="";const a=t.charCodeAt(0);for(;++o<n;)r=t.charCodeAt(o),s+=0!=r?r>=1&&r<=31||127==r||0==o&&r>=48&&r<=57||1==o&&r>=48&&r<=57&&45==a?"\\"+r.toString(16)+" ":0==o&&1==n&&45==r||!(r>=128||45==r||95==r||r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122)?"\\"+t.charAt(o):t.charAt(o):"ï¿½";return s}(e)}function o(e){return e.replace(new RegExp("#[^\\s.:\\[]+","g"),"")}n.d(t,{Q:()=>r,U:()=>o})},48211:(e,t,n)=>{n.d(t,{tS:()=>a,$o:()=>i,HS:()=>l});var r=n(74632),o=n(56091),s=n(72650);function a(e,t){const n=[];n.push((0,o.O)(e,{skipClasses:!1,maxAmountOfClasses:2,skipPrevSiblingId:!1,container:t})),n.push((0,o.O)(e,{skipClasses:!1,maxAmountOfClasses:2,noCombinator:!0,skipOfType:!0,skipPrevSiblingId:!1,container:t})),n.push((0,o.O)(e,{skipClasses:!1,maxAmountOfClasses:2,skipOfType:!0,skipTagName:!0,container:t})),n.push((0,o.O)(e,{skipClasses:!1,maxAmountOfClasses:1,skipDataAttrs:!1,maxAmountOfDataAttrs:1,skipOfType:!0,container:t})),n.push((0,o.O)(e,{skipDataAttrs:!1,maxAmountOfDataAttrs:2,container:t}));const r=(0,o.O)(e,{container:t});return r.includes("#")&&n.push(r),n}function i(e,t,n="CSS"){const o=e.map((e=>{if(!e.trim())return[];if(t||(t=document),":scope"===e.trim()&&t instanceof HTMLElement)return[t];if("XPath"===n){const n=function(e,t=document.body){return document.evaluate(e,t,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}(e,t);return n&&n instanceof HTMLElement?[n]:[]}const o=(0,s.$$)(e,t);return o.length?o:(0,s.$$)((0,r.U)(e),t)})).flat(1),a={};let i=0,l=1,c=null;return Array.from(o).forEach((e=>{let t=Number(e.getAttribute("bardeen-iteration-id"));t||(e.setAttribute("bardeen-iteration-id",l+""),t=l,l+=1),t in a||(a[t]=0),a[t]=a[t]+1,a[t]>i&&(i=a[t],c=e)})),Array.from(o).forEach((e=>{e.removeAttribute("bardeen-iteration-id")})),c}function l(e){const t=e.map((e=>Array.from(document.querySelectorAll(e)))).flat(1),n={};let r=0,o=1,s=null;return t.forEach((e=>{let t=Number(e.getAttribute("bardeen-iteration-id"));t||(e.setAttribute("bardeen-iteration-id",o+""),t=o,o+=1),t in n||(n[t]=0),n[t]=n[t]+1,n[t]>r&&(r=n[t],s=e)})),t.forEach((e=>{e.removeAttribute("bardeen-iteration-id")})),s}},56091:(e,t,n)=>{n.d(t,{O:()=>s,U:()=>u});var r=n(74632),o=n(72650);function s(e,t){const{skipOfType:n=!1,skipTagName:s=!1,skipClasses:u=!0,dropClassRate:d=0,randomizeClasses:p=!0,maxAmountOfClasses:h=2,skipId:f=!1,skipPrevSiblingId:m=!0,skipDataAttrs:g=!0,randomizeDataAttrs:b=!0,maxAmountOfDataAttrs:y=2,dropDataAttrRate:x=0,noCombinator:$=!1,stopWhenUnique:v=!0,container:E=null}=t||{},w=[];let S=e;for(;S&&S!==document.documentElement&&(!E||!(0,o.$$)(E).includes(S));){const e=s?"*":(0,r.Q)(S.tagName),t=[];if(!u){for(const e of Array.from(S.classList))/\d/.test(e)||e.includes("bardeen")||d&&Math.random()<d||t.push((0,r.Q)(e));p&&t.sort((()=>Math.random()-.5)),h&&t.length>h&&(t.length=h)}const o=`${t.length?".":""}${t.join(".")}`,$=S.id,v=!$||/\d/.test($)||f?"":`#${(0,r.Q)($)}`,E=!m&&c(S),A=v||!E||/\d/.test(E)||f?"":`${E} + `,k=[];if(!g){for(const{name:e,value:t}of Array.from(S.attributes))/\d/.test(t)||x&&Math.random()<x||e.startsWith("data")&&!e.includes("bardeen")&&k.push(`[${(0,r.Q)(e)}='${(0,r.Q)(t)}']`);b&&k.sort((()=>Math.random()-.5)),y&&k.length>y&&(k.length=y)}const C=`${A}${e}${v}${o}${k.join("")}${n||A?"":l(S)?":first-of-type":i(S)?":last-of-type":`:nth-of-type(${a(S)})`}`;w.push(C),S=S.parentElement}let A="";for(const e of w.filter((e=>e)))if(A=A?e+($?" ":" > ")+A:e,v&&1===(0,o.$$)(A).length)break;return E&&(A=`:scope ${A}`),A.trim()}function a(e){const t=e.tagName;let n=e,r=0;for(;n;)n.tagName==t&&r++,n=n.previousElementSibling;return r}function i(e){return e.matches(":last-of-type")}function l(e){return e.matches(":first-of-type")}function c(e){const t=[];let n="",o=e.previousElementSibling;for(;o;){if(o.id){n=`${(0,r.Q)(o.tagName)}#${(0,r.Q)(o.id)}${t.length?" + ":""}${t.join(" + ")}`;break}t.push((0,r.Q)(o.tagName)),o=o.previousElementSibling}return n}function u(e){const t=(e=>{if(0==e.length)return null;const t=e[0];let n=null,r=null,o=t.parentElement,s=t;for(;!n;)e.filter((e=>null==o?void 0:o.contains(e))).length===e.length&&(r=s,n=o),o=o?o.parentElement:null,s=s?s.parentElement:null;return{parent:n,child:r}})(e.reduce(((e,t)=>(t&&e.push(t),e)),[]));return t&&t.child?`${s(t.parent)} > ${t.child.tagName}`:null}},72650:(e,t,n)=>{n.d(t,{$$:()=>o,$:()=>s,sv:()=>a,I8:()=>i,Ak:()=>l,V:()=>c,El:()=>u,i7:()=>d,Kg:()=>p,_v:()=>h});var r=n(85795);const o=(e,t=document)=>{try{return Array.from(t.querySelectorAll(e))}catch(e){return console.error(e),[]}},s=(e,t=document)=>{try{return t.querySelector(e)}catch(e){return console.error(e),null}},a=r.ColorMap.grape.base,i=r.ColorMap.sky.base,l=r.ColorMap.raspberry.base,c="rgba(108, 240, 96, 0.5)",u="rgba(235, 175, 96, 0.5)";function d(e){return e.replace(/(\r\n|\n|\r)/gm,"")}async function p(e=1e4,t=300){let n=0;await async function(e,t,n=100){let r=!1;for(setTimeout((()=>(r=!0,!1)),t);!r;)try{if(e())return r=!0,!0;await h(n)}catch(e){console.log(`Scraper error: WaitFor condition failed: ${e.message||e.toString()}`),await h(100)}return!1}((()=>{const e=document.getElementsByTagName("*").length,t=e===n;return t||(n=e),t}),e,t)}const h=e=>new Promise((t=>setTimeout((()=>t(null)),e)))},43117:(e,t,n)=>{function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}n.d(t,{k:()=>r})},40831:(e,t,n)=>{n.d(t,{z:()=>u});var r=n(94216);class o{constructor(e){if(!e)throw new Error("No table is provided");this._results=[],this._headers=[],this._firstRowUsedAsHeaders=!1,this._processTable(e.cloneNode(!0))}static parse(e){const t=new o(e),{_results:n,_headers:r}=t;return{_results:n,_headers:r}}get headers(){return this._headers}_processTable(e){var t;this._results=[],this._buildHeaders(e);const n=e.querySelector("tr");null===(t=null==n?void 0:n.parentElement)||void 0===t||t.removeChild(n),this._parseBody(e)}_parseBody(e){const t=e.rows,n=t.length;for(let e=0;e<n;++e)this._results[e]={};for(let e=0;e<n;++e){const n=t[e];if(!n)continue;const r=n.cells;let o=0;for(let t=0,n=r.length;t<n;++t){const n=r[t];if(!n)continue;for(;this._results[e][this._headers[o]];)++o;const s=o+(n.colSpan||1),a=e+(n.rowSpan||1);for(let t=e;t<a;++t)for(let e=o;e<s;++e)this._results[t][this._headers[e]||e+1]=n.textContent||"";o=s}}this._results}_buildHeaders(e){this._headers=[];const t=["thead tr th","thead tr td","tr:nth-of-type(1) th","tr:nth-of-type(1) td"];for(const n of t){const t=e.querySelectorAll(n);if(t.length){t.forEach(((e,t)=>{var n;let r=(null===(n=e.textContent)||void 0===n?void 0:n.trim())||"_",o=2;for(;this._headers.includes(r);)r=`${r} (${o++})`;this._headers[t]=r}));break}}}}var s=n(72650),a=n(43117),i=n(91896),l=n(48211),c=n(71686);class u{constructor(){this.partialRendering=!0,this.errorHandlers=[]}async execute(e,t={},n,r){const o=(null==r?void 0:r.data)||[],a=t.preview?c.d:void 0,l=(null==r?void 0:r.containerIds)||await this.prepareContainers(e.container,a),{operations:u}=e;let d=(null==r?void 0:r.containerIndex)||0,p=0,h=[];for(;d<l.length;d++){const e=l[d];for((null==r?void 0:r.operationResults)?(h=null==r?void 0:r.operationResults,delete r.operationResults):h=[],(null==r?void 0:r.operationIndex)?(p=null==r?void 0:r.operationIndex,delete r.operationIndex):p=0;p<u.length;p++){const r=u[p];if(!r)continue;let a="";if(i.ScraperOperationTypes[r.type].special?a=await this.executeSpecialOperation(r)||"":await this.hasTarget(r.selector,e,r.selectorType)&&(["click","input"].includes(r.type)&&await n({data:o,operationResults:h,containerIds:l,containerIndex:d,operationIndex:p}),a=await this.executeOperations(r,e)),"image"===r.type&&!a){const n=await this.getBoundingRect(r,e);n&&t.captureActiveTabRegion&&(a=await t.captureActiveTabRegion(n))}i.ScraperOperationTypes[r.type].scraping?h.push(a):await(0,s.Kg)(1e3,200)}h.some((e=>e))&&o.push(h)}return o}async prepareContainers(e,t){const n=e,r=n?(0,s.$$)(n):[document.documentElement];r.length||this.logError("ScraperNoContainerFoundError");const o=[];return t&&r.length>t&&(r.length=t),r.forEach((e=>{if(e.dataset.bardeenScraping);else{const t=(0,a.k)();e.dataset.bardeenScraping=t,o.push(t)}})),o}cleanup(){Array.from((0,s.$$)("[data-bardeen-scraping]")).forEach((e=>delete e.dataset.bardeenScraping))}disablePartialRendering(){this.partialRendering=!1}async getBoundingRect(e,t){const n=(0,s.$)(`[data-bardeen-scraping="${t}"]`),r=e.selector,o=e.selectorType,a=(0,l.$o)(r,n,o);return null==a?void 0:a.getBoundingClientRect()}async executeSpecialOperation(e){var t;const{type:n,input:r}=e;switch(n){case"url":return window.location.href;case"title":return document.title;case"timestamp":return(new Date).toISOString();case"soc-image":return null===(t=document.querySelector("meta[property='og:image'], meta[name='twitter:image']"))||void 0===t?void 0:t.getAttribute("content");case"clipboard":return navigator.clipboard.readText();case"delay":{const e=parseFloat(r||"0");return await(0,s._v)(1e3*e),"Action executed"}}}async executeOperations(e,t){const n=(0,s.$)(`[data-bardeen-scraping="${t}"]`);let o=(0,l.$o)(e.selector,n,e.selectorType);if(!o)return"";switch(e.type){case"click":return(0,r.S)(o),"Action executed";case"input":{const t=e.input||e.name;return(0,r._)(o,t||""),"Action executed"}case"text":{let e="";return o&&(e=o.textContent||""),e=e.trim(),e}case"image":{const e=[],t=(e,t)=>{const{backgroundImage:n}=window.getComputedStyle(e,t),r=new RegExp('url\\(\\"(.*)\\"\\)'),o=n.match(r);return o?o[1]:null};return[o,...(0,s.$$)("*",o)].map((n=>{const{tagName:r}=n;"IMG"===r&&e.push(n.src),"VIDEO"===r&&e.push(n.poster);for(const r of[null,":after",":before"]){const o=t(n,r);o&&e.push(o)}})),e.join(", ")}case"link":{const e="audio, video",t=[...(0,s.$$)("[href]",o).map((e=>e.href)),...(0,s.$$)("[src]",o).filter((t=>t.closest(e))).map((e=>e.src)),...(0,s.$$)("iframe",o).map((e=>e.src))];for(;o&&o!==document.documentElement;){if(o.href){t.unshift(o.href);break}if(o.src&&o.closest(e)){t.unshift(o.src);break}o=o.parentElement}return t.join(", ")}case"attribute":{const t=e.input||"",n=o.getAttribute(t);if(n)return n;{const e=o.querySelector(`[${t}]`);return e?e.getAttribute(t):""}}default:return""}}getScrollParent(e){return null==e?null:e.scrollHeight>e.clientHeight?e:this.getScrollParent(e.parentElement)}scrollToBottom(e){const t=document.documentElement.scrollTop,n=(e?(0,s.$$)(e):[document.body])[0];if(n){const e=this.getScrollParent(n);e&&(e.scrollTop=e.scrollHeight)}return window.scrollTo(0,document.body.scrollHeight),t!==document.documentElement.scrollTop}async paginate(e,t){if("click"===e.type){this.scrollToBottom(t),await(0,s.Kg)(1e3);try{const n=e.selector;this.scrollToBottom(t);const o=(0,l.HS)(n||[]);o&&!(null==o?void 0:o.getAttribute("disabled"))?(0,r.S)(o):this.logError("ScraperNoPaginationFoundError")}catch(e){}}else"scroll"===e.type&&this.scrollToBottom(t);return(0,s.Kg)(5e3,500)}onError(e){this.errorHandlers.push(e)}logError(e){for(const t of this.errorHandlers)t(e)}getTable(e){const t=e[0],{selector:n,selectorType:r}=t,s=(0,l.$o)(n,null,r);return o.parse(s)}async hasTarget(e,t,n){const r=(0,s.$)(`[data-bardeen-scraping="${t}"]`);this.partialRendering&&(null==r||r.scrollIntoView());let o=(0,l.$o)(e,r,n);return!o&&this.partialRendering&&(o=(0,l.$o)(e,r,n)),!!o}}},71686:(e,t,n)=>{n.d(t,{d:()=>r});const r=1e3}}]);