"use strict";(self.webpackChunkbardeen_browser_extension=self.webpackChunkbardeen_browser_extension||[]).push([[3255],{10161:e=>{var t=Object.prototype.hasOwnProperty,n="~";function r(){}function s(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,i){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new s(r,o||e,i),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function i(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,s=[];if(0===this._eventsCount)return s;for(r in e=this._events)t.call(e,r)&&s.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(e)):s},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var s=0,o=r.length,i=new Array(o);s<o;s++)i[s]=r[s].fn;return i},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,s,o,i){var a=n?n+e:e;if(!this._events[a])return!1;var c,u,h=this._events[a],p=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),p){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,r),!0;case 4:return h.fn.call(h.context,t,r,s),!0;case 5:return h.fn.call(h.context,t,r,s,o),!0;case 6:return h.fn.call(h.context,t,r,s,o,i),!0}for(u=1,c=new Array(p-1);u<p;u++)c[u-1]=arguments[u];h.fn.apply(h.context,c)}else{var l,d=h.length;for(u=0;u<d;u++)switch(h[u].once&&this.removeListener(e,h[u].fn,void 0,!0),p){case 1:h[u].fn.call(h[u].context);break;case 2:h[u].fn.call(h[u].context,t);break;case 3:h[u].fn.call(h[u].context,t,r);break;case 4:h[u].fn.call(h[u].context,t,r,s);break;default:if(!c)for(l=1,c=new Array(p-1);l<p;l++)c[l-1]=arguments[l];h[u].fn.apply(h[u].context,c)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,s){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return i(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||s&&!a.once||r&&a.context!==r||i(this,o);else{for(var c=0,u=[],h=a.length;c<h;c++)(a[c].fn!==t||s&&!a[c].once||r&&a[c].context!==r)&&u.push(a[c]);u.length?this._events[o]=1===u.length?u[0]:u:i(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&i(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},12800:(e,t,n)=>{n.d(t,{p:()=>r});const r=(0,n(54178).n)({clientErrorCode:"AssertionError",message:"Assertion failed.",userHint:void 0,trackError:"default",arguments:[]})},11342:(e,t,n)=>{n.d(t,{O:()=>r});const r=(0,n(54178).n)({clientErrorCode:"BackendDisconnectedError",message:"The API endpoint is disconnected from the backend.",userHint:"API endpoint is disconnected from the back-end, please reload and try again.",trackError:!1,arguments:[]})},5191:(e,t,n)=>{n.d(t,{s:()=>o});var r=n(54178),s=n(46831);const o=(0,r.n)({clientErrorCode:"RetryableError",message:"Let's try that again.",userHint:"{{{message}}} This should work eventually, please try again.",trackError:!1,arguments:[{name:"message",type:String,struct:s.f.Scalar}]})},48849:(e,t,n)=>{n.r(t),n.d(t,{createAPIClient:()=>p});var r=n(72565),s=n.n(r),o=n(10161),i=n(91896),a=n(88767);function c(e,t={}){return s().runtime.sendMessage({call:e,data:t}).then((t=>t.error?(i.RetryableError.is(t.error)||console.error("RPC invoke of",e,"returned error:",t.value),Promise.reject(t.value)):t.value)).catch((t=>(i.RetryableError.is(t)||console.error("RPC invoke of",e,"failed:",t),Promise.reject(t))))}class u extends o.EventEmitter{constructor(){super(),this.lastConnected=0,this.port=null,this.handleDisconnect=()=>{this.pendingRpc.forEach(((e,t)=>{e(Promise.reject(i.BackendDisconnectedError.from({})))})),this.pendingRpc.clear(),this.port=null},this.handleMessage=(e,t)=>{switch(e.type){case"event":this.emit(e.name,...e.args||[]);break;case"response":{const t=this.pendingRpc.get(e.id);t&&(this.pendingRpc.delete(e.id),t(e.result));break}case"error":{const t=this.pendingRpc.get(e.id);t&&(this.pendingRpc.delete(e.id),t(Promise.reject(e.result)));break}}},this.rpc=async(e,t)=>{const n=await this.getPort(),r=(0,a.Z)();return new Promise(((s,o)=>{const a={id:r,name:e,type:"call",args:t};try{n.postMessage(a),this.pendingRpc.set(r,s)}catch(t){console.warn(`Error placing RPC request '${e}': ${(0,i.unknownToString)(t)}`),o(t)}}))},this.pendingRpc=new Map}async getPort(){if(!this.port){this.lastConnected=Date.now();const e=s().runtime.connect(void 0,{name:"bardeen.api"});e.onDisconnect.addListener(this.handleDisconnect),e.onMessage.addListener(this.handleMessage),this.port=e}return this.port}}class h{constructor(e){this.base=e}openSettings(e){const t=s().runtime.getURL("settings.html");window.open(e?t+`#/${e}`:t)}openErrors(){const e=s().runtime.getURL("settings.html");window.open(e+"#/errors")}openPlaybooks(e){const t=s().runtime.getURL("settings.html");window.open(t+"#/playbooks-catalog/?playbook="+e)}dedangle(e,t){("then"in e?e:e()).then((()=>{})).catch((e=>{console.error(e);const n=(0,i.isBardeenError)(e)?e:i.AssertionError.from({originalError:e});this.base.rpc("exceptionRegister",[{message:n.message,details:n,recoverable:!1,source:Object.assign({},t),date:Date.now()}])}))}authGetStatus(){return c("auth.rpc",{method:"authGetStatus",args:[]})}authFocusActive(){return c("auth.rpc",{method:"authFocusActive",args:[]})}promptSubmit(e){return c("auth.prompt.response",{method:"promptSubmit",args:e})}promptCancel(){return c("auth.prompt.cancel",{method:"promptCancel",args:[]})}authCancel(){return c("auth.rpc",{method:"authCancel",args:[]})}authContinue(){return c("auth.rpc",{method:"authContinue",args:[]})}authContinueOne(e){return c("auth.rpc",{method:"authContinueOne",args:[e]})}authDismissUI(){return c("auth.rpc",{method:"authDismissUI",args:[]})}}function p(){const e=new u,t=new h(e);return new Proxy(e,{get:(n,r)=>r in t?t[r]:r in e?e[r]:(...t)=>e.rpc(r,t)})}}}]);